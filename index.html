<!DOCTYPE html>
<html lang="en">
    <head>
        <met#aeb3b8et="utf-8">
        <title>Solai Rajan</title>
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <meta content="Free Website Template" name="keywords">
        <meta content="Free Website Template" name="description">

        <!-- Favicon -->
        <link href="favicon.ico" rel="icon">

        <!-- Google Web Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700&display=swap" rel="stylesheet">

        <!-- Icon Font Stylesheet -->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

        <!-- Libraries Stylesheet -->
        <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
        <link href="lib/lightbox/css/lightbox.min.css" rel="stylesheet">
        <link href="lib/animate/animate.min.css" rel="stylesheet">

        <!-- Customized Bootstrap Stylesheet -->
        <link href="css/bootstrap.min.css" rel="stylesheet">

        <!-- Template Stylesheet -->
        <link href="css/style.css" rel="stylesheet">
        <!-- google tag -->
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-N1B95KPKPF"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-N1B95KPKPF');
        </script>
    </head>

    <body>
        <!-- Spinner Start -->
        <div id="spinner" class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
            <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
                <span class="sr-only">Loading...</span>
            </div>
        </div>
        <!-- Spinner End -->

        <div class="container">
            <div class="row g-5">
                <div class="col-lg-4 sticky-lg-top vh-100">
                    <div class="d-flex flex-column h-100 text-center overflow-auto shadow " >
                        <img class="w-100 img-fluid mb-4 " src="img/profile.jpg" alt="Image">
                        <h1 class="text-primary mt-2">Solai Rajan</h1>
                        <div class="mb-4" style="height: 22px;">
                            <h4 class="typed-text-output d-inline-block text-light"></h4>
                            <div class="typed-text d-none">Cloud Engineer</div>
                        </div>
                        <div class="d-flex justify-content-center mt-auto mb-3">
                         <!--   <a class="btn btn-secondary btn-square mx-1" href="#"><i class="fab fa-twitter"></i></a>-->
                            <a class="btn btn-secondary btn-square mx-1" href="https://www.facebook.com/solai.abde"><i class="fab fa-facebook-f"></i></a>
                            <a class="btn btn-secondary btn-square mx-1" href="https://www.linkedin.com/in/solai-rajan-94479816b"><i class="fab fa-linkedin-in"></i></a>
                            <a class="btn btn-secondary btn-square mx-1" href="https://www.instagram.com/solai.kamaraj"><i class="fab fa-instagram"></i></a>
                            <a class="btn btn-secondary btn-square mx-1" href="https://wa.me/7299519004"><i class="fab fa-whatsapp"></i></a>
                            <a class="btn btn-secondary btn-square mx-1" href="https://linktr.ee/solairajan"><svg viewBox="0.641 1.282 417 512.238" width="1em" height="1em">
                                <path fill-rule="nonzero" d="M 171.915 346.224 L 246.005 346.224 L 246.005 513.52 L 171.915 513.52 L 171.915 346.224 Z M 0.641 174.75 L 126.709 174.75 L 37.087 89.31 L 86.678 38.325 L 172.117 126.154 L 172.117 1.282 L 246.203 1.282 L 246.203 126.154 L 331.641 38.525 L 381.193 89.31 L 291.613 174.55 L 417.641 174.55 L 417.641 245.052 L 290.893 245.052 L 381.076 332.681 L 331.641 382.474 L 209.16 259.392 L 86.678 382.474 L 37.087 332.883 L 127.305 245.252 L 0.641 245.252 L 0.641 174.75 L 0.641 174.75 Z" style="fill: rgb(242, 242, 242);"></path>
                              </svg></a>
                        </div>
                        <div class="d-flex align-items-end justify-content-between border-top">
                            <a href="solai_rajan_resume.pdf" target="_blank" class="btn w-50 border-end">Download CV</a>
                            <!-- <a href="#contact" class="btn w-50 btn-scroll">Contact Me</a> -->
                            <a href="my_tools.html" class="btn w-50 border-end" style="transition: all 0.3s ease-in-out;" onmouseover="this.style.backgroundColor='#007bff'; this.style.color='white';" onmouseout="this.style.backgroundColor=''; this.style.color='';">My Tools</a>
                        </div>
                    </div>
                </div>
                <div class="col-lg-8">

                    <!-- About Start -->
                    <section class="py-5 border-bottom wow fadeInUp" data-wow-delay="0.1s">
                        <div class="">
                       <a title="Click to verify" href="https://learn.microsoft.com/api/credentials/share/en-gb/SolaiRajan-3120/20E20661D6A24ACE?sharingId=9B779F8124134FC7" > <img class="float-end mb-3 awsbadge "  width="100" height="100" src="./img/Az-900.png" alt="Microsoft Certified: Azure Fundamentals"/></a>
                       <a title="Click to verify" href="https://www.credly.com/badges/0f8942c9-7fc0-4ece-8ca4-4f158a86ff04" > <img class="float-end mb-3 awsbadge "  width="100" height="100" src="./img/profile.png" alt="Aws Solution Architect Associate"/></a>
                        </div>
                        <h1 class="title pb-3 mb-5 w-75">About Me</h1>
                        <p>Motivated and detail-oriented Cloud Engineer with a strong focus on Amazon Web Services (AWS), proficient in designing, implementing, and managing cloud solutions on the AWS platform. Committed to staying up to date with the latest AWS trends, continuously expanding knowledge to deliver high-quality solutions. A collaborative team player with excellent problem-solving skills and a drive for innovation, ready to leverage AWS expertise to contribute to the success of organizations seeking cloud-based solutions.</p>
                        <div class="row mb-4">
                            <div class="col-sm-6 py-1">
                                <span class="fw-medium text-primary">Name:</span> Solai Rajan
                            </div>
                            <div class="col-sm-6 py-1">
                                <span class="fw-medium text-primary">Birthday:</span> 13 August 1998
                            </div>
                            <div class="col-sm-6 py-1">
                                <span class="fw-medium text-primary">Degree:</span> Bsc computer science
                            </div>
                            <div class="col-sm-6 py-1">
                                <span class="fw-medium text-primary">Experience:</span> 5 Years
                            </div>
                            <div class="col-sm-6 py-1">
                                <span class="fw-medium text-primary">Phone:</span> 7299519004
                            </div>
                            <div class="col-sm-6 py-1">
                                <span class="fw-medium text-primary">Email:</span> solai13kamaraj@gmail.com
                            </div>
                            <div class="col-sm-6 py-1">
                                <span class="fw-medium text-primary">Location:</span> Chennai, India
                            </div>
                            <div class="blinking-text">
                                " I measure my success by the knowledge I share, not the knowledge I keep ."
                            </div>
                        </div>
                        <!-- <div class="row g-4">
                            <div class="col-md-6 col-lg-6 col-xl-6">
                                <div class="d-flex bg-secondary p-4 justify-content-center">
                                    <h1 class="flex-shrink-0 display-5 text-primary mb-0" data-toggle="counter-up">3</h1>
                                    <div class="ps-3">
                                        <p class="mb-0">Years of</p>
                                        <h5 class="mb-0">Experience</h5>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 col-lg-6 col-xl-6">
                                <div class="d-flex bg-secondary p-4 justify-content-center">
                                    <h1 class="flex-shrink-0 display-5 text-primary mb-0"  id="visit-count" data-toggle="counter-up"></h1>
                                   
                                    
                                    <div class="ps-3">
                                        <p class="mb-0">Profile</p>
                                        <h5 class="mb-0">Visits</h5>
                                    </div>
                                </div>
                                <div  ></div>
  
  


                            </div>
                            <div class="col-md-4 col-lg-6 col-xl-4">
                                <div class="d-flex bg-secondary p-4">
                                    <h1 class="flex-shrink-0 display-5 text-primary mb-0" data-toggle="counter-up">200</h1>
                                    <div class="ps-3">
                                        <p class="mb-0">Complete</p>
                                        <h5 class="mb-0">Projects</h5>
                                    </div>
                                </div>
                            </div>
                        </div> -->
                    </section>
                    <!-- About End -->

                    <!-- Skills Start  -->
                    <section class="py-5 border-bottom wow fadeInUp" data-wow-delay="0.1s">
                        <h1 class="title pb-3 mb-5">Skills</h1>
                        <div class="row">
                            <div class="col-sm-6">
                                <h5>Terraform</h5>
                                    
                                    <h5>Python</h5>
                                    <h5>Pytest</h5>
                                    <h5>Gitlab</h5>
                                    <h5>Basics of Linux</h5>
                                    <h5>Windows server(IIS)</h5>
                            </div>
                            <div class="col-sm-6">
                                <h5>AWS</h5>
                                <p>(Iam, Vpc, Ec2, S3, Lambda, Api Gateway, Dynamodb, Cloud Watch, Cloud Trail, Route 53, SNS,SQS, Athena, Rds, Glue, AWS directory service, WAF, SES)</p>
                                <p><h5 class="px-1">Azure</h5>
                                    (Azure AD, Vnets, Azure Vm, Blob storage, Azure SQL Databases )
                                </p>
                                
                            </div>
                        </div>
                    </section>
                    <!-- Skills End -->

                    <!-- Expericence Start -->
                    <section class="py-5 wow fadeInUp" data-wow-delay="0.1s">
                        <h1 class="title pb-3 mb-5">Experience</h1>
                        <div class="border-start border-2 border-light pt-2 ps-5">
                            
                            <div class="position-relative mb-4">
                                <span class="bi bi-arrow-right fs-4 text-light position-absolute" style="top: -5px; left: -50px;"></span>
                                <h5 class="mb-1">Cloud Engineer</h5>
                                <p class="mb-2">HTC Global Services | <small>February 2022 - Till Now</small></p>
                                <strong>Mainframe to AWS Modernization</strong><br>
                                <strong>Client:</strong> <a href="https://www.statefarm.com/" target="_blank">State Farm</a>
                                    <ul>
                                    <li>Developed a high-availability API on AWS as part of a modernization project transitioning from mainframe to AWS, utilizing API Gateway (private endpoint) to integrate a private Lambda and DynamoDB for backend operations.</li>
                                    <li>Implemented disaster recovery (DR) across two regions, deploying API Gateway, Lambda functions, and load balancers in each region and using DynamoDB Global Tables for cross-region data replication.</li>
                                    <li>Configured Route 53 failover routing with a multi-region load balancer setup and health checks for seamless traffic redirection to healthy endpoints in the event of failure.</li>
                                    <li>Automated API health monitoring with EventBridge-triggered Lambda functions, which conducted health checks via DynamoDB scans and activated CloudWatch alarms based on API responses.</li>
                                    <li>Streamlined DR failover process by integrating Route 53 health checks with CloudWatch alarms, ensuring minimal downtime and consistent API availability for end-users.</li>
                                    <li>Created AWS resources using reusable Terraform modules designed for modular consumption, incorporating custom templates for specific services, all stored in GitLab to ensure accessibility across projects.</li>
                                    <li>Leveraged a GitLab CI/CD pipeline integrated with Scalr for Terraform state management, utilized Terratest for automated infrastructure code validation, and implemented security compliance checks using Sync Scan and LabLooter, alongside a Pytest stage for unit testing Python code deployed in AWS Lambda functions.</li>
                                    </ul>

                                    <strong>Data Migration of DB2 to DynamoDB</strong>
                                    <ul>
                                    <li>Executed end-to-end data migration from DB2 to DynamoDB, leveraging AWS Transfer Service, S3, Glue, and VPC Endpoint for secure operations.</li>
                                    <li>Configured AWS Transfer Service with VPC Endpoint to enable private, efficient data transfers to S3.</li>
                                    <li>Performed ETL with AWS Glue to transform and prepare DB2 data for seamless integration with DynamoDB.</li>
                                    <li>Enhanced data security and integrity throughout the migration, ensuring compliance with best practices.</li>
                                    <li>Optimized DynamoDB setup post-migration, enabling fast, reliable data access for application needs.</li>
                                    <li>Deployed all AWS resources using modular Terraform code, creating reusable modules and templates stored in GitLab for easy cross-project use. The GitLab pipeline utilized Scalr for Terraform state file handling and incorporated Terratest for code validation.</li>
                                    <li>Integrated continuous security checks with Sync Scan and LabLooter in the pipeline stages, and added a Pytest stage to validate the Python code used in AWS Glue.</li>
                                    </ul>

                                    <strong>API Lambda Development Project</strong>
                                    <ul>
                                    <li>Developed Python code for AWS Lambda functions to support API operations, structuring code into modular files to streamline execution and ensure only necessary code runs.</li>
                                    <li>Implemented robust input validation and comprehensive exception handling, adhering to best practices and standardized naming conventions to improve code readability and maintainability.</li>
                                    <li>Optimized Lambda performance by minimizing execution time and memory usage, ensuring efficient resource utilization.</li>
                                    <li>Designed and implemented unit tests with Pytest to validate code functionality, improving reliability and enabling continuous integration with automated testing in the pipeline.</li>
                                    <li>Created High-Level Design (HLD), Low-Level Design (LLD), and component specification documents to detail the architecture, design considerations, and component specifics, enhancing project clarity and support for future development.</li>
                                    </ul>

                                    <strong>Atos Cloud to AWS Migration</strong><br>
                                    <strong>Client:</strong> <a href="https://www.domesticappliances.philips.co.in/" target="_blank">Philips DA</a>
                                    <ul>
                                    <li>Collaborated on migrating a .NET application and SQL Server database from Atos Cloud to AWS.</li>
                                    <li>Analyzed infrastructure and defined migration requirements with the team.</li>
                                    <li>Configured AWS services, including EC2 for application hosting and RDS for SQL Server.</li>
                                    <li>Installed necessary software and dependencies, ensuring compatibility.</li>
                                    <li>Supported testing to validate functionality and performance post-migration.</li>
                                    <li>Delivered solutions tailored to stakeholder needs, addressing migration challenges.</li>
                                    </ul>

                                </div>
                            <div class="position-relative mb-4">
                                <span class="bi bi-arrow-right fs-4 text-light position-absolute" style="top: -5px; left: -50px;"></span>
                                <h5 class="mb-1">Network Infrastructure Design</h5>
                                <p class="mb-2">Accenture | <small>MARCH 2020 - OCTOBER 2021</small></p>
                                <strong>Client:</strong> <a href="https://tdcgroup.com/" target="_blank">TDC</a>
                                    <ul>
                                        <li>Utilized the INCA tool to strategically design fiber cable placements across Denmark.</li>
                                        <li>Developed accurate network maps by referencing legacy copper cable layouts, transitioning the design from copper to modern fiber infrastructure.</li>
                                        <li>Ensured optimized internet infrastructure to support advanced connectivity needs by leveraging geographic data and existing network schematics.</li>
                                    </ul>    
                                </div>
                        </div>
                    </section>
                    <!-- Expericence End -->

                    <!-- Education Start -->
                    <section class="py-5 wow fadeInUp" data-wow-delay="0.1s">
                        <h1 class="title pb-3 mb-5">Education</h1>
                        <div class="border-start border-2 border-light pt-2 ps-5">
                            <div class="position-relative mb-4">
                                <span class="bi bi-arrow-right fs-4 text-light position-absolute" style="top: -5px; left: -50px;"></span>
                                <h5 class="mb-1">Bachelor Degree</h5>
                                <p class="mb-2">K.C.S Kasi Nadar College Of Arts & Science | <small>2016 - 2019</small></p>
                                <p>B.SC (Computer Science)
                                    Percentage - 56 % <br>Chennai - 21</p>
                            </div>
                            <div class="position-relative mb-4">
                                <span class="bi bi-arrow-right fs-4 text-light position-absolute" style="top: -5px; left: -50px;"></span>
                                <h5 class="mb-1">High School</h5>
                                <p class="mb-2">Sagaya Matha Matriculation Hr Sec School | <small>2015 - 2016</small></p>
                                <p>HSC Percentage - 55 %<br>Chennai - 57</p>
                            </div>
                            <div class="position-relative mb-4">
                                <span class="bi bi-arrow-right fs-4 text-light position-absolute" style="top: -5px; left: -50px;"></span>
                                <h5 class="mb-1">School</h5>
                                <p class="mb-2">Sagaya Matha Matriculation Hr Sec School | <small>2013 - 2014</small></p>
                                <p>SSLC Percentage - 69 %<br>Chennai - 57</p>
                            </div>
                        </div>
                    </section>
                    <!-- Education End -->

                    <!-- Subscribe Start 
                    <section class="wow fadeInUp" data-wow-delay="0.1s">
                        <div class="bg-secondary text-center p-5">
                            <h1 class="text-white font-weight-bold">Subscribe My Newsletter</h1>
                            <p class="text-white">Subscribe and get my latest article in your inbox</p>
                            <div class="position-relative w-100">
                                <input class="form-control bg-dark border-0 w-100 py-3 ps-4 pe-5" type="text" placeholder="Your email">
                                <button type="button" class="btn btn-primary py-2 position-absolute top-0 end-0 mt-2 me-2">Subscribe</button>
                            </div>
                        </div>
                    </section>
                    <!-- Subscribe End -->

                    <!-- Services Start 
                    <section class="py-5 border-bottom wow fadeInUp" data-wow-delay="0.1s">
                        <h1 class="title pb-3 mb-5">Services</h1>
                        <div class="row g-4">
                            <div class="col-md-6">
                                <div class="service-item">
                                    <i class="fa fa-2x fa-laptop-code mx-auto mb-4"></i>
                                    <h5 class="mb-2">Web Design</h5>
                                    <p class="mb-0">Justo sit justo eos amet tempor amet clita amet ipsum eos elitr. Amet lorem lorem lorem est amet labore</p>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="service-item">
                                    <i class="fab fa-2x fa-android mx-auto mb-4"></i>
                                    <h5 class="mb-2">Apps Development</h5>
                                    <p class="mb-0">Justo sit justo eos amet tempor amet clita amet ipsum eos elitr. Amet lorem lorem lorem est amet labore</p>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="service-item">
                                    <i class="fa fa-2x fa-search mx-auto mb-4"></i>
                                    <h5 class="mb-2">SEO</h5>
                                    <p class="mb-0">Justo sit justo eos amet tempor amet clita amet ipsum eos elitr. Amet lorem lorem lorem est amet labore</p>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="service-item">
                                    <i class="fa fa-2x fa-edit mx-auto mb-4"></i>
                                    <h5 class="mb-2">Content Creating</h5>
                                    <p class="mb-0">Justo sit justo eos amet tempor amet clita amet ipsum eos elitr. Amet lorem lorem lorem est amet labore</p>
                                </div>
                            </div>
                        </div>
                    </section>
                    <!-- Services End -->

                    <!-- Portfolio Start -->
                    <section class="py-5 border-bottom wow fadeInUp" data-wow-delay="0.1s">
                        <h1 class="title pb-3 mb-5">Weekend Projects</h1>
                        <div class="row">
                            <div class="col-12">
                                <div class="row">
                                    <div class="col-12 text-center mb-2">
                                        <!-- <ul class="list-inline mb-4" id="portfolio-flters">
                                            <li class="btn btn-secondary active"  data-filter="*"><i class="fa fa-star me-2"></i>All</li>
                                            <li class="btn btn-secondary" data-filter=".first"><i class="fa fa-laptop-code me-2"></i>Design</li>
                                            <li class="btn btn-secondary" data-filter=".second"><i class="fa fa-mobile-alt me-2"></i>Development</li>
                                        </ul> -->
                                    </div>
                                </div>
                                <div class="row portfolio-container">
                                    <div class="col-md-6 mb-4 portfolio-item first">
                                        <div class="position-relative overflow-hidden mb-2" style="transition: transform 0.3s ease-in-out;" onmouseover="this.style.transform='scale(1.05)';" onmouseout="this.style.transform='scale(1)';">
                                            <a href="https://solairajan18.medium.com/recovering-or-replacing-a-key-pair-in-aws-ec2-a-step-by-step-guide-d3fbfe94aa65" target="_blank">
                                                <img class="img-fluid w-75" src="img/portfolio-1.jpg" alt="">
                                            </a>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-4 portfolio-item second">
                                        <div class="position-relative overflow-hidden mb-2" style="transition: transform 0.3s ease-in-out;" onmouseover="this.style.transform='scale(1.05)';" onmouseout="this.style.transform='scale(1)';">
                                            <a href="https://medium.com/@solairajan18/title-deploying-a-portfolio-web-application-on-windows-server-iis-using-aws-terraform-5306d148678f" target="_blank">
                                                <img class="img-fluid w-75" src="img/portfolio-2.jpg" alt="">
                                            </a>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-4 portfolio-item second">
                                        <div class="position-relative overflow-hidden mb-2" style="transition: transform 0.3s ease-in-out;" onmouseover="this.style.transform='scale(1.05)';" onmouseout="this.style.transform='scale(1)';">
                                            <a href="https://solairajan18.medium.com/how-to-access-aws-console-using-azure-ad-sso-saml-federation-d48493456910" target="_blank">
                                                <img class="img-fluid w-75" src="img/portfolio-3.jpg" alt="">
                                            </a>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-4 portfolio-item second">
                                        <div class="position-relative overflow-hidden mb-2" style="transition: transform 0.3s ease-in-out;" onmouseover="this.style.transform='scale(1.05)';" onmouseout="this.style.transform='scale(1)';">
                                            <a href="https://medium.com/@solairajan18/how-to-access-aws-using-oidc-role-in-gitlab-runner-8d9570635aaa" target="_blank">
                                                <img class="img-fluid w-75" src="img/portfolio-4.jpg" alt="">
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                    <!-- <div class="col-md-6 mb-4 portfolio-item first">
                                        <div class="position-relative overflow-hidden mb-2">
                                            <img class="img-fluid w-100" src="img/portfolio-3.jpg" alt="">
                                            <div class="portfolio-btn d-flex align-items-center justify-content-center">
                                                <a href="img/portfolio-3.jpg" data-lightbox="portfolio">
                                                    <i class="bi bi-plus text-light"></i>
                                                </a>
                                            </div>
                                        </div>
                                    </div> -->
                                    <!-- <div class="col-md-6 mb-4 portfolio-item second">
                                        <div class="position-relative overflow-hidden mb-2">
                                            <img class="img-fluid w-100" src="img/portfolio-4.jpg" alt="">
                                            <div class="portfolio-btn d-flex align-items-center justify-content-center">
                                                <a href="img/portfolio-4.jpg" data-lightbox="portfolio">
                                                    <i class="bi bi-plus text-light"></i>
                                                </a>
                                            </div>
                                        </div>
                                    </div> -->
                                <!-- </div> -->
                            </div>
                        </div>
                    </section>
                    <!-- Portfolio End -->

                    <!-- Testimonial Start 
                    <section class="py-5 border-bottom wow fadeInUp" data-wow-delay="0.1s">
                        <h1 class="title pb-3 mb-5">Testimonial</h1>
                        <div class="owl-carousel testimonial-carousel">
                            <div class="text-left">
                                <i class="fa fa-3x fa-quote-left text-primary mb-4"></i>
                                <p class="fs-4 mb-4">Dolor eirmod diam stet kasd sed. Aliqu rebum est eos. Rebum elitr dolore et eos labore, stet justo sed est sed. Diam sed sed dolor stet accusam amet eirmod eos, labore diam clita</p>
                                <div class="d-flex align-items-center">
                                    <img class="img-fluid" src="img/testimonial-1.jpg" style="width: 60px; height: 60px;">
                                    <div class="ps-3">
                                        <p class="text-primary fs-5 mb-1">Client Name</p>
                                        <i>Profession</i>
                                    </div>
                                </div>
                            </div>
                            <div class="text-left">
                                <i class="fa fa-3x fa-quote-left text-primary mb-4"></i>
                                <p class="fs-4 mb-4">Dolor eirmod diam stet kasd sed. Aliqu rebum est eos. Rebum elitr dolore et eos labore, stet justo sed est sed. Diam sed sed dolor stet accusam amet eirmod eos, labore diam clita</p>
                                <div class="d-flex align-items-center">
                                    <img class="img-fluid" src="img/testimonial-2.jpg" style="width: 60px; height: 60px;">
                                    <div class="ps-3">
                                        <p class="text-primary fs-5 mb-1">Client Name</p>
                                        <i>Profession</i>
                                    </div>
                                </div>
                            </div>
                            <div class="text-left">
                                <i class="fa fa-3x fa-quote-left text-primary mb-4"></i>
                                <p class="fs-4 mb-4">Dolor eirmod diam stet kasd sed. Aliqu rebum est eos. Rebum elitr dolore et eos labore, stet justo sed est sed. Diam sed sed dolor stet accusam amet eirmod eos, labore diam clita</p>
                                <div class="d-flex align-items-center">
                                    <img class="img-fluid" src="img/testimonial-3.jpg" style="width: 60px; height: 60px;">
                                    <div class="ps-3">
                                        <p class="text-primary fs-5 mb-1">Client Name</p>
                                        <i>Profession</i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <!-- Testimonial End -->

                    <!-- Contact Start -->
<div id="validation-popup" class="validation-popup"></div>

<section class="py-5 wow fadeInUp" data-wow-delay="0.1s" id="contact">
    <h1 class="title pb-3 mb-5">Contact Me</h1>

    <form class="needs-validation" onsubmit="return validateForm(event)" action="https://docs.google.com/forms/u/0/d/e/1FAIpQLSfPLlt-WYPMHcCRsRIOEYpXYlZdo9-Mu41EpkZ92HWi8DZNXg/formResponse" novalidate>
        <div class="row g-3">
            <div class="col-md-6">
                <div class="form-floating">
                    <input type="text" name="entry.2005620554" class="form-control border-0 bg-secondary" id="name" placeholder="Your Name" required>
                    <label for="name">Your Name</label>
                    <div class="invalid-feedback">Enter Your Name</div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-floating">
                    <input type="email" name="entry.1045781291" class="form-control border-0 bg-secondary" id="email" placeholder="Your Email" required>
                    <label for="email">Your Email</label>
                    <div class="invalid-feedback">Enter Your email</div>
                </div>
            </div>
            <div class="col-12">
                <div class="form-floating">
                    <input type="text" name="entry.1065046570" class="form-control border-0 bg-secondary" id="subject" placeholder="Subject" required>
                    <label for="subject">Subject</label>
                    <div class="invalid-feedback">Enter Your Subject</div>
                </div>
            </div>
            <div class="col-12">
                <div class="form-floating">
                    <textarea class="form-control border-0 bg-secondary" required name="entry.1166974658" placeholder="Leave a message here" id="message" style="height: 200px"></textarea>
                    <label for="message">Message</label>
                    <div class="invalid-feedback">Enter Your Message</div>
                </div>
            </div>

            <!-- CAPTCHA -->
            <div class="col-12">
                <div class="g-recaptcha" data-sitekey="6LexdBUrAAAAAKNIqLk61spt3wHS5llpUcEdnvJx"></div>
                <div id="captcha-error" class="text-danger mt-2" style="display: none;">Please complete the CAPTCHA</div>
            </div>

            <audio id="clickSound" src="welcome.mp3" preload="auto"></audio>

            <div class="col-12">
                <button onclick="playClickSound()" class="btn btn-primary w-100 py-3" type="submit">Send Message</button>
            </div>
        </div>
    </form>
</section>
                    <!-- Contact End -->
<!-- Add reCAPTCHA JS -->
<script src="https://www.google.com/recaptcha/api.js" async defer></script>

<script>
    function playClickSound() {
        const clickSound = document.getElementById('clickSound');
        if (clickSound) clickSound.play();
    }

    function validateForm(event) {
        const captchaResponse = grecaptcha.getResponse();
        const captchaError = document.getElementById("captcha-error");

        if (captchaResponse.length === 0) {
            event.preventDefault(); // stop form submission
            captchaError.style.display = "block";
            return false;
        } else {
            captchaError.style.display = "none";
        }

        return true; // continue form submission
    }
</script>
                    <!-- Footer Start -->
                    <section class="wow fadeIn" data-wow-delay="0.1s">
                        <div class="bg-secondary text-light text-center p-5">
                            <div class="d-flex justify-content-center mb-4">
                                
                                <a class="btn btn-dark btn-square mx-1" href="https://www.facebook.com/solai.abde"><i class="fab fa-facebook-f"></i></a>
                                <a class="btn btn-dark btn-square mx-1" href="https://www.linkedin.com/in/solai-rajan-94479816b"><i class="fab fa-linkedin-in"></i></a>
                                <a class="btn btn-dark btn-square mx-1" href="https://www.instagram.com/solai.kamaraj/"><i class="fab fa-instagram"></i></a>
                                <a class="btn btn-dark btn-square mx-1" href="https://wa.me/7299519004?text=Hi Solai"><i class="fab fa-whatsapp"></i></a>
                                <a class="btn btn-dark btn-square mx-1" href="https://linktr.ee/solairajan"><svg viewBox="641 1282 417 512.238" width="1em" height="1em">
                                    <path fill-rule="nonzero" d="M 171.915 346.224 L 246.005 346.224 L 246.005 513.52 L 171.915 513.52 L 171.915 346.224 Z M 0.641 174.75 L 126.709 174.75 L 37.087 89.31 L 86.678 38.325 L 172.117 126.154 L 172.117 1.282 L 246.203 1.282 L 246.203 126.154 L 331.641 38.525 L 381.193 89.31 L 291.613 174.55 L 417.641 174.55 L 417.641 245.052 L 290.893 245.052 L 381.076 332.681 L 331.641 382.474 L 209.16 259.392 L 86.678 382.474 L 37.087 332.883 L 127.305 245.252 L 0.641 245.252 L 0.641 174.75 L 0.641 174.75 Z" style="fill: rgb(242, 242, 242);"></path>
                                  </svg></a>
                                  <a class="btn btn-dark btn-square mx-1" href="https://solairajan18.medium.com/"><svg viewBox="0 0 1043.63 592.71" class="aa bb">
                                    <g data-name="Layer 2"><g data-name="Layer 1">
                                      <path fill-rule="nonzero" d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0
                                      296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0
                                      154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279
                                      147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76
                                      249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9
                                      51.76 249.94"style="fill: rgb(242, 242, 242);"></path>
                                    </g></g>
                                  </svg></a>
                            </div>
                            <!-- <div class="d-flex justify-content-center mb-3">
                                <a class="text-light px-3 border-end" href="#">Privacy</a>
                                <a class="text-light px-3 border-end" href="#">Terms</a>
                                <a class="text-light px-3 border-end" href="#">FAQs</a>
                                <a class="text-light px-3" href="#">Help</a>
                            </div> -->
							
                            <!--/*** This template is free as long as you keep the footer author’s credit link/attribution link/backlink. If you'd like to use the template without the footer author’s credit link/attribution link/backlink, you can purchase the Credit Removal License from "https://htmlcodex.com/credit-removal". Thank you for your support. ***/-->
							<p class="m-0"> Powered by <a href="https://solairajan.online">Solai</a></p>
                        </div>
                    </section>
                    <!-- Footer End -->
                </div>
            </div>
        </div>

        
        <!-- Back to Top -->
        <a href="#" class="back-to-top"><i class="fa fa-angle-double-up"></i></a>
        
        <!-- JavaScript Libraries -->
        <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
        <script src="lib/wow/wow.min.js"></script>
        <script src="lib/typed/typed.min.js"></script>
        <script src="lib/easing/easing.min.js"></script>
        <script src="lib/waypoints/waypoints.min.js"></script>
        <script src="lib/counterup/counterup.min.js"></script>
        <script src="lib/owlcarousel/owl.carousel.min.js"></script>
        <script src="lib/isotope/isotope.pkgd.min.js"></script>
        <script src="lib/lightbox/js/lightbox.min.js"></script>

        <!-- Contact Javascript File -->
        <script src="mail/jqBootstrapValidation.min.js"></script>
        <script src="mail/contact.js"></script>

        <!-- Template Javascript -->
        <script src="js/main.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/12.0.1/marked.min.js"></script>



        <!-- Include the JavaScript code to fetch and display the visit count -->
        <!-- <script>
            // Fetch the visit count from Google Analytics
            gtag('event', 'page_view', {
              'event_callback': function() {
                var visitCount = window.ga.getAll()[0].get('metric1'); // Adjust the metric index if necessary
                document.getElementById('visit-count-placeholder').innerHTML = 'Profile visits: ' + visitCount;
              }
            });
          </script> -->
    <!-- Chat Interface -->
<div class="chat-container">
    <div class="chat-icon" onclick="toggleChat()">
        <span class="ai-text">AI</span>
    </div>
    <div class="chat-window">
        <div class="chat-header" style="display: flex; align-items: flex-start; justify-content: space-between;">
            <div style="display: flex; flex-direction: column; flex: 1;">
                <h5 style="margin: 0;">Sol<span style="color: rgb(33, 233, 26); font-weight: bold;">AI</span></h5>
                <div class="api-selector">
                    <input type="radio" id="rest-api" name="api-type" value="rest" checked>
                    <label for="rest-api">REST</label>
                    <input type="radio" id="ws-api" name="api-type" value="ws">
                    <label for="ws-api">WebSocket</label>
                    <span id="ws-status"></span>
                </div>
            </div>
            <button class="close-btn" onclick="toggleChat()" style="align-self: flex-start; margin-left: 10px;">&times;</button>
        </div>
        <div class="chat-messages" id="chat-messages">
            <!-- Typing indicator will be inserted dynamically -->
        </div>
        <div class="chat-input">
            <input type="text" id="user-input" placeholder="Type your message...">
            <button onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>
        </div>
        <div class="chat-footer">
            <a href="#" onclick="openFeedback(event)">Provide feedback</a>
        </div>
        <div class="feedback-window" id="feedback-window" style="display:none;">
            <div class="feedback-content">
                <h6 style="margin:0 0 8px 0; color:#fff; padding-top: 4px;">Help improve <span style="font-weight:bold; background: linear-gradient(90deg, #00B87B 0%, #007bff 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; text-fill-color: transparent;">Sol AI</span> by providing your feedback:</h6>
                <textarea id="feedback-text" placeholder="Write your feedback..."></textarea>
                <div class="feedback-actions">
                    <button onclick="closeFeedback()" class="feedback-back-btn">Back to chat</button>
                    <button onclick="submitFeedback()">Submit</button>
                </div>
                <p id="feedback-status"></p>
            </div>
        </div>
        <!-- Success toast popup -->
        <div id="feedback-toast" class="feedback-toast" style="display:none;" aria-live="polite" aria-atomic="true">
            <div class="toast-card">Thank you for your valuable feedback ❤️</div>
        </div>
    </div>
</div>

<style>
.chat-container {
    position: fixed;
    bottom: 90px;
    right: 20px;
    z-index: 1000;
}

.api-selector {
    font-size: 0.8rem;
    margin-top: 4px;
    color: #ccc;
}
.api-selector input {
    margin-left: 5px;
}
.api-selector label {
    cursor: pointer;
}
#ws-status {
    margin-left: 10px;
    font-weight: bold;
}
#ws-status.connecting { color: #ffe066; }
#ws-status.connected { color: #21e91a; }
#ws-status.disconnected { color: #ff6b6b; }

.chat-icon {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    background: linear-gradient(135deg, #00B87B 0%, #007bff 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 0 0 0 rgba(0,184,123,0.7), 0 2px 8px rgba(0,0,0,0.18);
    cursor: pointer;
    transition: transform 0.18s cubic-bezier(.4,0,.2,1), box-shadow 0.18s cubic-bezier(.4,0,.2,1);
    animation: chat-glow 1.5s infinite alternate;
}

@keyframes chat-glow {
    0% {
        box-shadow: 0 0 0 0 rgba(0,184,123,0.7), 0 2px 8px rgba(0,0,0,0.18);
    }
    100% {
        box-shadow: 0 0 18px 6px rgba(0,184,123,0.45), 0 2px 16px rgba(0,123,255,0.25);
    }
}

.chat-icon:hover {
    transform: scale(1.08);
    animation-play-state: paused;
    box-shadow: 0 0 32px 12px rgba(0,184,123,0.7), 0 2px 16px rgba(0,123,255,0.35);
}

.ai-text {
    font-family: 'Heebo', 'Segoe UI', Arial, sans-serif;
    font-weight: 900;
    font-size: 1.6rem;
    letter-spacing: 0.04em;
    color: #fff;
    text-shadow: 0 2px 12px rgba(0,0,0,0.18), 0 0 8px #00B87B, 0 0 12px #007bff;
    user-select: none;
    pointer-events: none;
}

@media (max-width: 600px) {
    .chat-icon {
        width: 48px;
        height: 48px;
    }
    .ai-text {
        font-size: 1.1rem;
    }
    .chat-window {
        width: 98vw;
        max-width: 360px;
        right: 0;
        left: auto;
    }
}

/* Redesigned chat styles for a modern, beautiful look */
.chat-window {
    display: none;
    width: 340px;
    background: #23272f;
    border-radius: 18px;
    box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
    overflow: hidden;
    animation: chat-fade-in 0.5s cubic-bezier(.4,0,.2,1);
}

@keyframes chat-fade-in {
    from { opacity: 0; transform: translateY(40px) scale(0.95); }
    to { opacity: 1; transform: translateY(0) scale(1); }
}

.chat-header {
    background: linear-gradient(90deg, #00B87B 0%, #007bff 100%);
    color: #fff;
    padding: 16px 20px;
    border-radius: 18px 18px 0 0;
    font-weight: 600;
    font-size: 1.1rem;
    letter-spacing: 0.5px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.07);
}

.chat-messages {
    height: 340px;
    overflow-y: auto;
    padding: 18px 16px;
    background: #1a1d23;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.message {
    margin-bottom: 0;
    padding: 12px 14px;
    border-radius: 12px;
    max-width: 85%;
    word-break: break-word;
    box-shadow: 0 1px 4px rgba(0,0,0,0.08);
    font-size: 1rem;
    line-height: 1.5;
    transition: background 0.3s, color 0.3s;
}

.user-message {
    background: linear-gradient(90deg, #007bff 60%, #00B87B 100%);
    color: #fff;
    align-self: flex-end;
    margin-left: 15%;
    border-bottom-right-radius: 4px;
}

.bot-message {
    background: #fff;
    color: #23272f;
    align-self: flex-start;
    margin-right: 15%;
    border-bottom-left-radius: 4px;
    position: relative;
    overflow-wrap: break-word;
    word-break: break-word;
}

.bot-message a {
    color: #007bff !important;
    background: #e6f0ff;
    padding: 2px 6px;
    border-radius: 4px;
    text-decoration: underline;
    font-weight: 600;
    transition: background 0.2s, color 0.2s;
    word-break: break-all;
}
.bot-message a:hover {
    background: #00B87B;
    color: #fff !important;
    text-decoration: none;
}

.chat-input {
    display: flex;
    padding: 12px 10px;
    background: #23272f;
    border-top: 1px solid #22242a;
}

.chat-input input {
    flex: 1;
    padding: 10px 12px;
    border: none;
    border-radius: 6px;
    margin-right: 8px;
    background: #181a20;
    color: #fff;
    font-size: 1rem;
    outline: none;
    transition: background 0.2s;
}

.chat-input input:focus {
    background: #23272f;
}

.chat-footer {
    padding: 8px 12px;
    background: #23272f;
    border-top: 1px solid #22242a;
    text-align: center; /* bottom center alignment */
}
.chat-footer a {
    color: #b5b5b5; /* gray link */
    text-decoration: none; /* remove underline */
    font-size: 0.95rem;
}
.chat-footer a:hover {
    color: #ffffff;
}

.feedback-window {
    background: #1a1d23;
    border-top: 1px solid #22242a;
}
.feedback-content {
    height: 340px; /* match chat-messages height */
    padding: 16px;
    display: flex;
    flex-direction: column;
    position: relative; /* allow positioned actions bar */
}
.feedback-content textarea {
    flex: 1;
    resize: vertical;
    min-height: 180px;
    background: #181a20;
    color: #fff;
    border: none;
    border-radius: 6px;
    padding: 10px 12px;
    outline: none;
}
.feedback-actions {
    position: absolute;
    bottom: 8px;
    left: 12px;
    right: 12px;
    display: flex;
    align-items: center;
    justify-content: space-between; /* align back-left and submit-right */
}
.feedback-back-btn {
    position: static; /* align within actions bar */
}

/* Animated status message for feedback submission */
#feedback-status {
    color: #cfe9ff;
    min-height: 22px;
    margin-top: 6px;
}
#feedback-status.success {
    color: #21e91a;
    animation: feedbackFadeIn 400ms ease-out, feedbackGlow 1600ms ease-in-out 2;
}
@keyframes feedbackFadeIn {
    0% { opacity: 0; transform: translateY(6px); }
    100% { opacity: 1; transform: translateY(0); }
}
@keyframes feedbackGlow {
    0%, 100% { text-shadow: none; }
    50% { text-shadow: 0 0 8px rgba(33,233,26,0.6), 0 0 12px rgba(0,123,255,0.4); }
}

/* Toast popup for feedback success */
.feedback-toast {
    position: absolute;
    inset: 0;
    display: none; /* toggled to flex when shown */
    align-items: center;
    justify-content: center;
    background: rgba(0,0,0,0.35);
    z-index: 5;
}
.feedback-toast .toast-card {
    background: #222630;
    color: #fff;
    padding: 14px 18px;
    border-radius: 10px;
    box-shadow: 0 10px 28px rgba(0,0,0,0.35);
    font-size: 1rem;
    letter-spacing: 0.2px;
    animation: toastPop 280ms ease-out;
}
@keyframes toastPop {
    0% { opacity: 0; transform: scale(0.92); }
    100% { opacity: 1; transform: scale(1); }
}

button {
    background: linear-gradient(90deg, #00B87B 0%, #007bff 100%);
    color: #fff;
    border: none;
    border-radius: 6px;
    padding: 0 18px;
    font-size: 1.2rem;
    cursor: pointer;
    transition: background 0.2s, color 0.2s;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
}
button:hover {
    background: #007bff;
    color: #fff;
}

.close-btn {
    background: none;
    border: none;
    color: #fff;
    font-size: 1.5rem;
    cursor: pointer;
    opacity: 0.7;
    transition: opacity 0.2s;
}
.close-btn:hover {
    opacity: 1;
}

.typing-indicator {
    display: flex;
    align-items: center;
    height: 28px;
    margin-bottom: 2px;
    margin-top: 2px;
    padding-left: 2px;
}
.typing-indicator .dot {
    width: 8px;
    height: 8px;
    margin: 0 2px;
    border-radius: 50%;
    background: #00B87B;
    opacity: 0.7;
    animation: bounce 1.2s infinite both;
    display: inline-block;
}
.typing-indicator .dot:nth-child(2) {
    animation-delay: 0.2s;
}
.typing-indicator .dot:nth-child(3) {
    animation-delay: 0.4s;
}
@keyframes bounce {
    0%, 80%, 100% {
        transform: translateY(0);
        opacity: 0.7;
    }
    40% {
        transform: translateY(-8px);
        opacity: 1;
    }
}
</style>

<script>
    let socket = null;
    let apiMode = 'rest';
    const wsUrl = 'wss://web-socket-2-3knj.onrender.com';
    let wsRetryCount = 0;
    const maxWsRetries = 12; // 12 retries * 5 seconds = 1 minute
    const wsRetryDelay = 5000; // 5 seconds
    let wsSessionId = null; // 1. Store the session ID

    function setWsStatus(status, text) {
        const statusEl = document.getElementById('ws-status');
        statusEl.className = status;
        statusEl.textContent = text;
    }

    function initWebSocket() {
        if (socket && (socket.readyState === WebSocket.OPEN || socket.readyState === WebSocket.CONNECTING)) {
            return;
        }
        socket = new WebSocket(wsUrl);
        setWsStatus('connecting', 'Connecting...');

        socket.onopen = () => {
            setWsStatus('connected', 'Connected');
            wsRetryCount = 0; // Reset counter on successful connection
        };

        socket.onmessage = (event) => {
            const messagesDiv = document.getElementById('chat-messages');
            const typingIndicator = messagesDiv.querySelector('.typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }

            try {
                const data = JSON.parse(event.data);
                const botMessageChunk = data.message || "";

                // 2. Extract and store the session ID from the server's response
                if (data.session_id) {
                    wsSessionId = data.session_id;
                }

                if (botMessageChunk) {
                    let lastBotMessageDiv = messagesDiv.querySelector('.message.bot-message:last-of-type');
                    
                    // If there's no last message, or it's not streaming, create a new one.
                    if (!lastBotMessageDiv || !lastBotMessageDiv.streamAnimator) {
                        lastBotMessageDiv = document.createElement("div");
                        lastBotMessageDiv.classList.add("message", "bot-message");
                        messagesDiv.appendChild(lastBotMessageDiv);
                        // Attach the new animator to the element itself
                        lastBotMessageDiv.streamAnimator = new StreamAnimator(lastBotMessageDiv);
                    }

                    // Add the new chunk to the animator's queue
                    lastBotMessageDiv.streamAnimator.addChunk(botMessageChunk);
                    messagesDiv.scrollTop = messagesDiv.scrollHeight;
                }

            } catch (error) {
                console.error("Error processing WebSocket message:", error, "Data:", event.data);
            }
        };

        socket.onerror = (error) => {
            console.error("WebSocket Error:", error);
            // onclose will be called automatically after an error, where we handle the retry.
        };

        socket.onclose = () => {
            socket = null;
            wsSessionId = null; // Reset session ID on disconnection
            // Only retry if we are still in WebSocket mode
            if (apiMode === 'ws' && wsRetryCount < maxWsRetries) {
                wsRetryCount++;
                setWsStatus('connecting', `Retrying... (${wsRetryCount})`);
                setTimeout(initWebSocket, wsRetryDelay);
            } else {
                setWsStatus('disconnected', 'Disconnected');
                wsRetryCount = 0; // Reset for next manual attempt
            }
        };
    }

    function closeWebSocket() {
        wsRetryCount = maxWsRetries; // Prevent retries when manually closing
        if (socket) {
            socket.onclose = null; // Prevent onclose handler from firing on manual close
            socket.close();
            socket = null;
        }
        setWsStatus('', '');
    }

    document.querySelectorAll('input[name="api-type"]').forEach(radio => {
        radio.addEventListener('change', (event) => {
            apiMode = event.target.value;
            if (apiMode === 'ws') {
                initWebSocket();
            } else {
                closeWebSocket();
            }
        });
    });

    function toggleChat() {
        const chatWindow = document.querySelector('.chat-window');
        chatWindow.style.display = chatWindow.style.display === 'none' || chatWindow.style.display === '' ? 'block' : 'none';

        // Add a random greeting if chat is empty and opening
        if (chatWindow.style.display === 'block') {
            const messagesDiv = document.getElementById('chat-messages');
            if (messagesDiv.children.length === 0) {
                const highlight = '<span style="font-weight:bold; background: linear-gradient(90deg, #00B87B 0%, #007bff 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; text-fill-color: transparent;">Sol AI</span>';
                const greetings = [
                    `👋 Hey, how can I help you? I am ${highlight}.`,
                    `😊 Hello! Ask me anything, I'm ${highlight}.`,
                    `🤖 Hi there! ${highlight} at your service. How can I assist?`,
                    `🙌 Greetings! I'm ${highlight}. What can I do for you today?`
                ];
                const randomGreeting = greetings[Math.floor(Math.random() * greetings.length)];
                const botMessageDiv = document.createElement("div");
                botMessageDiv.classList.add("message", "bot-message");
                botMessageDiv.innerHTML = randomGreeting;
                messagesDiv.appendChild(botMessageDiv);
            }
        }
    }

    // Helper: typewriter effect for HTML content
    function typeBotMessage(element, html, delay = 18) {
        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = html;
        const nodes = Array.from(tempDiv.childNodes);
        element.innerHTML = '';
        let nodeIdx = 0;

        function typeNode(node, parent) {
            if (node.nodeType === Node.TEXT_NODE) {
                let text = node.textContent;
                let i = 0;
                function typeChar() {
                    if (i < text.length) {
                        parent.appendChild(document.createTextNode(text[i]));
                        i++;
                        setTimeout(typeChar, delay);
                        element.scrollIntoView({ behavior: "smooth", block: "end" });
                    } else {
                        typeNextNode();
                    }
                }
                typeChar();
            } else if (node.nodeType === Node.ELEMENT_NODE) {
                const el = document.createElement(node.nodeName);
                for (let attr of node.attributes) {
                    el.setAttribute(attr.name, attr.value);
                }
                parent.appendChild(el);
                let childNodes = Array.from(node.childNodes);
                let childIdx = 0;
                function typeChild() {
                    if (childIdx < childNodes.length) {
                        typeNode(childNodes[childIdx], el);
                        childIdx++;
                    } else {
                        typeNextNode();
                    }
                }
                if (childNodes.length > 0) {
                    typeNode(childNodes[childIdx], el);
                    childIdx++;
                } else {
                    typeNextNode();
                }
            } else {
                typeNextNode();
            }
        }

        function typeNextNode() {
            nodeIdx++;
            if (nodeIdx < nodes.length) {
                typeNode(nodes[nodeIdx], element);
            }
        }

        if (nodes.length > 0) {
            typeNode(nodes[nodeIdx], element);
        }
    }

    class StreamAnimator {
        constructor(element) {
            this.element = element;
            this.fullText = "";
            this.queue = [];
            this.isRendering = false;
            this.speed = 30; // Milliseconds per render cycle
        }

        addChunk(chunk) {
            this.queue.push(...chunk.split(''));
            if (!this.isRendering) {
                this.render();
            }
        }

        render() {
            this.isRendering = true;
            const startTime = performance.now();

            const animate = (currentTime) => {
                // Add characters from the queue to the full text
                while (this.queue.length > 0) {
                    this.fullText += this.queue.shift();
                    // Break the loop if we've spent enough time in this frame
                    if (performance.now() - startTime > 16) break; 
                }

                // Render the current full text as Markdown
                this.element.innerHTML = marked.parse(this.fullText);
                this.element.scrollIntoView({ behavior: "smooth", block: "end" });

                // If there are still characters in the queue, continue the animation
                if (this.queue.length > 0) {
                    requestAnimationFrame(animate);
                } else {
                    this.isRendering = false;
                    // Final render to ensure everything is up to date
                    this.element.innerHTML = marked.parse(this.fullText);
                    // Re-apply syntax highlighting if you use a library like highlight.js
                    // For example: this.element.querySelectorAll('pre code').forEach(block => hljs.highlightBlock(block));
                }
            };

            requestAnimationFrame(animate);
        }
    }

    async function sendMessage() {
        const userInput = document.getElementById('user-input');
        const message = userInput.value.trim();
        
        if (!message) return;

        const messagesDiv = document.getElementById('chat-messages');

        // Add user message
        const userMessageDiv = document.createElement("div");
        userMessageDiv.classList.add("message", "user-message");
        userMessageDiv.textContent = message;
        messagesDiv.appendChild(userMessageDiv);

        userInput.value = '';
        messagesDiv.scrollTop = messagesDiv.scrollHeight;

        if (apiMode === 'ws') {
            if (socket && socket.readyState === WebSocket.OPEN) {
                const typingIndicator = document.createElement("div");
                typingIndicator.className = "typing-indicator";
                typingIndicator.innerHTML = '<span class="dot"></span><span class="dot"></span><span class="dot"></span>';
                messagesDiv.appendChild(typingIndicator);
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
                
                // **FIX:** Clear the animator from the previous bot message before sending a new one.
                let lastBotMessageDiv = messagesDiv.querySelector('.message.bot-message:last-of-type');
                if (lastBotMessageDiv && lastBotMessageDiv.streamAnimator) {
                    lastBotMessageDiv.streamAnimator = null;
                }

                // 3. Send the session ID back to the server
                const payload = { message: message };
                if (wsSessionId) {
                    payload.session_id = wsSessionId;
                }
                socket.send(JSON.stringify(payload));
            } else {
                const botMessageDiv = document.createElement("div");
                botMessageDiv.classList.add("message", "bot-message");
                botMessageDiv.textContent = "WebSocket not connected. Please wait or switch to REST API.";
                messagesDiv.appendChild(botMessageDiv);
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
            }
            return;
        }

        // REST API logic
        const typingIndicator = document.createElement("div");
        typingIndicator.className = "typing-indicator";
        typingIndicator.innerHTML = '<span class="dot"></span><span class="dot"></span><span class="dot"></span>';
        messagesDiv.appendChild(typingIndicator);
        messagesDiv.scrollTop = messagesDiv.scrollHeight;

        try {
            const response = await fetch('https://flask-hello-world-six-murex-51.vercel.app/', {
            // const response = await fetch('http://127.0.0.1:8000/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ message: message })
            });

            if (typingIndicator.parentNode) {
                typingIndicator.parentNode.removeChild(typingIndicator);
            }

            let botMessageDiv = document.createElement("div");
            botMessageDiv.classList.add("message", "bot-message");
            messagesDiv.appendChild(botMessageDiv);

            if (response.ok) {
                const data = await response.json();
                const html = marked.parse(data.response);
                typeBotMessage(botMessageDiv, html);
            } else {
                typeBotMessage(botMessageDiv, "Server is busy, please try again later.");
            }

        } catch (error) {
            if (typingIndicator.parentNode) {
                typingIndicator.parentNode.removeChild(typingIndicator);
            }
            const botMessageDiv = document.createElement("div");
            botMessageDiv.classList.add("message", "bot-message");
            messagesDiv.appendChild(botMessageDiv);
            const errorMessages = [
                "Oops! My circuits are tangled. Try again in a bit 🤖🔌",
                "Server is taking a nap. Please wake it up by trying again soon 😴💤",
                "I'm lost in the cloud... Try again and I’ll find my way back! ☁️🧭",
                "Yikes! The server tripped over a cable. Give it another shot! ⚡️🙈",
                "Server is busy chasing bugs. Try again and I’ll be right with you! 🐞🚀"
            ];
            const randomMsg = errorMessages[Math.floor(Math.random() * errorMessages.length)];
            typeBotMessage(botMessageDiv, randomMsg);
            console.error("Error:", error);
        }

        messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }

    // Handle Enter key for input
    document.getElementById('user-input').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            sendMessage();
        }
    });

    // Feedback form toggling
    function openFeedback(e) {
        if (e) e.preventDefault();
        const fw = document.getElementById('feedback-window');
        const messages = document.querySelector('.chat-messages');
        const input = document.querySelector('.chat-input');
        const footer = document.querySelector('.chat-footer');
        fw.style.display = 'block';
        messages.style.display = 'none';
        input.style.display = 'none';
        footer.style.display = 'none';
    }

    function closeFeedback(e) {
        if (e) e.preventDefault();
        const fw = document.getElementById('feedback-window');
        const messages = document.querySelector('.chat-messages');
        const input = document.querySelector('.chat-input');
        const footer = document.querySelector('.chat-footer');
        const toast = document.getElementById('feedback-toast');
        fw.style.display = 'none';
        messages.style.display = 'flex';
        input.style.display = 'flex';
        footer.style.display = 'block';
        if (toast) toast.style.display = 'none';
        const statusEl = document.getElementById('feedback-status');
        if (statusEl) statusEl.textContent = '';
    }

    // Submit feedback to Google Form backend (from form.html)
    function submitFeedback() {
        const feedbackEl = document.getElementById('feedback-text');
        const statusEl = document.getElementById('feedback-status');
        const feedback = feedbackEl.value.trim();
        if (!feedback) {
            statusEl.textContent = '⚠️ Please enter feedback.';
            return;
        }

        const url = 'https://docs.google.com/forms/u/0/d/e/1FAIpQLScuChiAISSfQ2Lq_f-utJ8dvJGUjVj5SX7es3pkPkHjWnQLhw/formResponse';
        const formData = new FormData();
        formData.append('entry.1496290439', feedback);

        fetch(url, {
            method: 'POST',
            mode: 'no-cors',
            body: formData
        }).then(() => {
            // Clear inline status and show toast popup
            statusEl.textContent = '';
            feedbackEl.value = '';
            const toast = document.getElementById('feedback-toast');
            toast.style.display = 'flex';
            // Auto-hide toast after a short delay, then return to chat
            setTimeout(() => {
                toast.style.display = 'none';
                closeFeedback();
            }, 2400);
        }).catch(err => {
            statusEl.textContent = '❌ Error submitting feedback.';
            statusEl.classList.remove('success');
            console.error(err);
        });
    }
</script>
    </body>
</html>